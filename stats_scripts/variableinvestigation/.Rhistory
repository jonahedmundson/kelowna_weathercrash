scale_y_continuous(labels = scales::label_number(suffix = "°C")) +
theme(panel.grid.major.y = element_line(color = "#8ccde3",
size = 0.25,
linetype = 2))
#alldata %>%
ggplot(data = alldata, aes(x=monthnumber, y=Temp...C.)) +
geom_boxplot(aes(x=Month.Of.Year), colour='#00008b', fill='#6495ed') +
geom_smooth(stat = 'summary', alpha = 0.2, fill = '#6495ed', color = '#00008b',
fun.data = median_hilow, fun.args = list(conf.int = 1)) +
#geom_boxplot(data=weatherdata, aes(x=Month.Of.Year), colour='#00008b', fill='#6495ed') +
geom_smooth(data=weatherdata, aes(x=Month.Of.Year), stat = 'summary', alpha = 0.2, fill = 'red', color = 'red',
fun.data = median_hilow, fun.args = list(conf.int = 1)) +
#geom_line(stat='summary', fun='median', color='#00008b', lwd=1.2) +
xlab('') +
ylab('Temperature') +
scale_x_discrete(labels=month.abb) +
scale_y_continuous(labels = scales::label_number(suffix = "°C")) +
theme(panel.grid.major.y = element_line(color = "#8ccde3",
size = 0.25,
linetype = 2))
names(weatherdata)
names(alldata)
log(10)
log10(10)
library(ggplot2)
library(ggthemes)
theme_set(theme_few())
library(tidyverse)
load_first_object <- function(fname){
#this function was written by Dr. Rhonda Rosychuk at the U of A
e <- new.env(parent = parent.frame())
load(fname, e)
return(e[[ls(e)[1]]])
}
#cleaned and combined
alldata = load_first_object("../../rda_files/all_data.rda")
#reading as.factor
factors = c("Fog", "Freezing.Rain", "Snow", "Rain", "Thunderstorms")
for (i in factors){
alldata[,i] = as.factor(alldata[,i])
}
#weatherdata
weatherdata = c()
for (i in c(2017:2021)){
for (j in c(1:12)){
temp = subset(read.csv(paste0('../../weatherdata/en_climate_hourly_BC_1123939_',
sprintf("%02d", j), '-', i, '_P1H.csv')),
select = - c(`Temp.Flag`,
`Dew.Point.Temp.Flag`, `Rel.Hum.Flag`,
`Precip..Amount.Flag`, `Wind.Dir.Flag`,
`Wind.Spd.Flag`, `Visibility.Flag`,
`Stn.Press.Flag`, `Hmdx`, `Hmdx.Flag`, `Wind.Chill.Flag`))
weatherdata = rbind(weatherdata, temp)
}
}
alldata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month.Of.Year)) +
geom_line()
alldata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month.Of.Year)) +
geom_density()
alldata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month.Of.Year)) +
geom_smooth(stat = 'summary')
alldata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month.Of.Year)) +
geom_smooth(stat = 'summary', fun.data = mean)
rlang::last_error()
alldata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month)) +
geom_smooth(stat = 'summary', fun.data = mean)
#making monthnumber column
alldata[,"monthnumber"] = match(tolower(alldata$Month.Of.Year),
tolower(month.name))
alldata %>%
ggplot(aes(y=Precip..Amount..mm., x=monthnumber)) +
geom_smooth(stat = 'summary', fun.data = mean)
alldata %>%
ggplot(aes(y=Precip..Amount..mm., x=monthnumber)) +
geom_ribbon(stat = 'summary', fun.data = mean)
alldata %>%
ggplot(aes(y=Precip..Amount..mm., x=monthnumber)) +
geom_line()
alldata %>%
ggplot(aes(y=Precip..Amount..mm., x=monthnumber)) +
geom_line(stat = 'summary')
alldata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month.Of.Year)) +
geom_line(stat = 'summary')
alldata %>%
ggplot(aes(y=Precip..Amount..mm., x=monthnumber)) +
geom_line(stat = 'summary')
alldata %>%
ggplot(aes(y=Precip..Amount..mm., x=monthnumber)) +
geom_line(stat = 'summary', fun = mean)
alldata %>%
ggplot(aes(y=Precip..Amount..mm., x=monthnumber)) +
geom_line(stat = 'summary', fun = mean, fill = '#6495ed', color = '#00008b')
weatherdata[,"monthnumber"] = match(tolower(weatherdata$Month.Of.Year),
tolower(month.name))
names(weatherdata)
table(weatherdata$monthnumber)
alldata %>%
ggplot(aes(y=Precip..Amount..mm., x=monthnumber)) +
geom_line(stat = 'summary', fun = mean, color = '#00008b') +
geom_line(data=weatherdata, aes(x=Month))
alldata %>%
ggplot(aes(y=Precip..Amount..mm., x=monthnumber)) +
geom_line(stat = 'summary', fun = mean, color = '#00008b') +
geom_line(data=weatherdata, aes(x=Month), stat = 'summary', fun = mean, color='red')
alldata %>%
ggplot(aes(y=Precip..Amount..mm., x=monthnumber)) +
geom_line(stat = 'summary', fun = mean, color = '#6495ed', lwd=2) +
geom_line(data=weatherdata, aes(x=Month), stat = 'summary', fun = mean, color='#00008b', lwd=2)
weatherdata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month)) +
geom_line(stat = 'summary', fun = mean, color = '#6495ed', lwd=2) +
geom_line(data=alldata, aes(x=monthnumber), stat = 'summary', fun = mean, color='#00008b', lwd=2)
weatherdata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month)) +
geom_line(stat = 'summary', fun = mean, color = '#00008b', lwd=2) +
geom_line(data=alldata, aes(x=monthnumber), stat = 'summary', fun = mean, color='#6495ed', lwd=2)
weatherdata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month)) +
geom_line(stat = 'summary', fun = mean, color = '#00008b', lwd=2, alpha=0.5) +
geom_line(data=alldata, aes(x=monthnumber), stat = 'summary', fun = mean, color='#6495ed', lwd=2)
weatherdata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month)) +
geom_line(stat = 'summary', fun = mean, color = '#00008b', lwd=2, alpha=0.5) +
geom_line(data=alldata, aes(x=monthnumber), stat = 'summary', fun = mean, color='#6495ed', lwd=2, alpha=1)
weatherdata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month)) +
geom_line(stat = 'summary', fun = mean, color = '#00008b', lwd=2) +
geom_are() +
geom_line(data=alldata, aes(x=monthnumber), stat = 'summary', fun = mean, color='#6495ed', lwd=2)
weatherdata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month)) +
geom_line(stat = 'summary', fun = mean, color = '#00008b', lwd=2) +
geom_area() +
geom_line(data=alldata, aes(x=monthnumber), stat = 'summary', fun = mean, color='#6495ed', lwd=2)
weatherdata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month)) +
geom_line(stat = 'summary', fun = mean, color = '#00008b', lwd=2) +
geom_area(stat = 'summary', fun = mean) +
geom_line(data=alldata, aes(x=monthnumber), stat = 'summary', fun = mean, color='#6495ed', lwd=2)
weatherdata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month)) +
geom_area(stat = 'summary', fun = mean, color = '#00008b', lwd=2) +
geom_area(data=alldata, aes(x=monthnumber), stat = 'summary', fun = mean, color='#6495ed', lwd=2)
weatherdata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month)) +
geom_area(stat = 'summary', fun = mean, color = '#00008b',
fill = '#00008b', alpha=0.3) +
geom_area(data=alldata, aes(x=monthnumber), stat = 'summary',
fun = mean, color='#6495ed', fill='#6495ed', alpha=0.3)
weatherdata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month)) +
geom_area(stat = 'summary', fun = mean, color = '',
fill = '#00008b', alpha=0.3) +
geom_area(data=alldata, aes(x=monthnumber), stat = 'summary',
fun = mean, color='', fill='#6495ed', alpha=0.3)
weatherdata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month)) +
geom_area(stat = 'summary', fun = mean, lty = 0,
fill = '#00008b', alpha=0.3) +
geom_area(data=alldata, aes(x=monthnumber), stat = 'summary',
fun = mean, lty = 0, fill='#6495ed', alpha=0.3)
weatherdata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month)) +
geom_area(stat = 'summary', fun = mean, lty = 0,
fill = '#00008b', alpha=0.3) +
geom_area(data=alldata, aes(x=monthnumber), stat = 'summary',
fun = mean, lty = 0, fill='#6495ed', alpha=0.5)
weatherdata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month)) +
geom_area(stat = 'summary', fun = mean, lty = 0,
fill = '#00008b', alpha=0.5) +
geom_area(data=alldata, aes(x=monthnumber), stat = 'summary',
fun = mean, lty = 0, fill='#6495ed', alpha=0.5)
table(round(alldata$Precip..Amount..mm.))
weatherdata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month)) +
geom_area(stat = 'summary', fun = mean, lty = 0,
fill = '#00008b', alpha=0.5) +
geom_area(data=alldata, aes(x=monthnumber), stat = 'summary',
fun = mean, lty = 0, fill='#6495ed', alpha=0.6) +
annotate(
geom="text", x=c(8, 2), y=c(0.03, 0.045), label=c("Year-round", "Crash temps"),
color=c("#1d2951", "#6495ed")
)
names(alldata)
alldata %>%
ggplot(aes(x=monthnumber, y=Wind.Dir..10s.deg)) +
geom_boxplot(aes(x=Month.Of.Year), colour='#00008b', fill='#6495ed') +
geom_smooth(stat = 'summary', alpha = 0.2, fill = '#6495ed', color = '#00008b',
fun.data = median_hilow, fun.args = list(conf.int = 1)) +
xlab('') +
ylab('Wind Direction') +
scale_x_discrete(labels=month.abb) +
scale_y_continuous(labels = scales::label_number(suffix = "°")) +
theme(panel.grid.major.y = element_line(color = "#8ccde3",
size = 0.25,
linetype = 2))
alldata %>%
ggplot(aes(x=monthnumber, y=Temp...C.)) +
geom_boxplot(aes(x=Month.Of.Year), colour='#00008b', fill='#6495ed') +
geom_smooth(stat = 'summary', alpha = 0.2, fill = '#6495ed', color = '#00008b',
fun.data = median_hilow, fun.args = list(conf.int = 1)) +
#geom_line(stat='summary', fun='median', color='#00008b', lwd=1.2) +
xlab('') +
ylab('Temperature') +
scale_x_discrete(labels=month.abb) +
scale_y_continuous(labels = scales::label_number(suffix = "°C")) +
theme(panel.grid.major.y = element_line(color = "#8ccde3",
size = 0.25,
linetype = 2))
alldata %>%
ggplot(aes(x=monthnumber, y=Temp...C.)) +
geom_boxplot(aes(x=Month.Of.Year), colour='#00008b', fill='#6495ed') +
geom_smooth(stat = 'summary', alpha = 0.2, fill = '#6495ed', color = '#00008b',
fun.data = median_hilow, fun.args = list(conf.int = 1)) +
#geom_line(stat='summary', fun='median', color='#00008b', lwd=1.2) +
xlab('') +
ylab('Temperature') +
scale_x_discrete(labels=month.abb) +
scale_y_continuous(labels = scales::label_number(suffix = "°C")) #+
alldata %>%
ggplot(aes(x=monthnumber, y=Temp...C.)) +
geom_boxplot(aes(x=Month.Of.Year), colour='#00008b', fill='#6495ed') +
geom_smooth(stat = 'summary', alpha = 0.2, fill = '#6495ed', color = '#00008b',
fun.data = median_hilow, fun.args = list(conf.int = 1)) +
#geom_line(stat='summary', fun='median', color='#00008b', lwd=1.2) +
xlab('') +
ylab('Temperature') +
scale_x_discrete(labels=month.abb) +
scale_y_continuous(labels = scales::label_number(suffix = "°C")) +
theme(panel.grid.major.y = element_line(color = "#8ccde3",
size = 0.25,
linetype = 2))
alldata %>%
ggplot(aes(x=monthnumber, y=Wind.Dir..10s.deg)) +
geom_boxplot(aes(x=Month.Of.Year), colour='#00008b', fill='#6495ed') +
geom_smooth(stat = 'summary', alpha = 0.2, fill = '#6495ed', color = '#00008b',
fun.data = median_hilow, fun.args = list(conf.int = 1)) +
xlab('') +
ylab('Wind Direction') +
scale_x_discrete(labels=month.abb) +
scale_y_continuous(labels = scales::label_number(suffix = "°"))
names(weatherdarta)
names(weatherdata)
data.frame(
'Avg humidity' = mean(weatherdata$'Wind.Dir..10s.deg.', na.rm=TRUE),
'Avg crash humidity' = mean(alldata$'Wind.Dir..10s.deg.', na.rm = TRUE)
)
ggplot(data=weatherdata, aes(x=Wind.Dir..10s.deg.)) +
geom_density(colour='#1d2951', fill='#1d2951', alpha=0.9) +
geom_density(data=alldata, colour='#6495ed', fill='#6495ed', alpha=0.6) +
xlab('Wind Direction') +
ylab('Density') +
annotate(
geom="text", x=c(72, 30), y=c(0.0175, 0.0155), label=c("Year-round", "Crash temps"),
color=c("#1d2951", "#6495ed")
)
alldata %>%
ggplot(aes(x=monthnumber, y=Wind.Dir..10s.deg.)) +
geom_boxplot(aes(x=Month.Of.Year), colour='#00008b', fill='#6495ed') +
geom_smooth(stat = 'summary', alpha = 0.2, fill = '#6495ed', color = '#00008b',
fun.data = median_hilow, fun.args = list(conf.int = 1)) +
xlab('') +
ylab('Wind Direction') +
scale_x_discrete(labels=month.abb) +
scale_y_continuous(labels = scales::label_number(suffix = "°"))
alldata %>%
ggplot(aes(x=monthnumber, y=Wind.Dir..10s.deg.)) +
geom_boxplot(aes(x=Month.Of.Year), colour='#00008b', fill='#6495ed') +
geom_smooth(stat = 'summary', alpha = 0.2, fill = '#6495ed', color = '#00008b',
fun.data = median_hilow, fun.args = list(conf.int = 1)) +
xlab('') +
ylab('Wind Direction') +
scale_x_discrete(labels=month.abb) +
scale_y_continuous(labels = scales::label_number(suffix = "°"))
alldata %>%
ggplot(aes(x=monthnumber, y=Wind.Dir..10s.deg.)) +
geom_boxplot(aes(x=Month.Of.Year), colour='#00008b', fill='#6495ed') +
geom_smooth(stat = 'summary', alpha = 0.2, fill = '#6495ed', color = '#00008b',
fun.data = median_hilow, fun.args = list(conf.int = 1)) +
xlab('') +
ylab('Wind Direction') +
scale_x_discrete(labels=month.abb) +
scale_y_continuous(trans = function(x) 10*x,
labels = scales::label_number(suffix = "°"))
data.frame(
'Avg humidity' = mean(weatherdata$'Wind.Dir..10s.deg.', na.rm=TRUE),
'Avg crash humidity' = mean(alldata$'Wind.Dir..10s.deg.', na.rm = TRUE)
)
ggplot(data=weatherdata, aes(x=Wind.Dir..10s.deg.)) +
geom_density(colour='#1d2951', fill='#1d2951', alpha=0.9) +
geom_density(data=alldata, colour='#6495ed', fill='#6495ed', alpha=0.6) +
xlab('Wind Direction') +
ylab('Density') +
annotate(
geom="text", x=c(72, 30), y=c(0.0175, 0.0155), label=c("Year-round", "Crash temps"),
color=c("#1d2951", "#6495ed")
) +
scale_x_continuous(labels = scales::label_number(suffix = "0°"))
ggplot(data=weatherdata, aes(x=Wind.Dir..10s.deg.)) +
geom_density(colour='#1d2951', fill='#1d2951', alpha=0.9) +
geom_density(data=alldata, colour='#6495ed', fill='#6495ed', alpha=0.6) +
xlab('Wind Direction') +
ylab('Density') +
annotate(
geom="text", x=c(72, 30), y=c(0.0175, 0.0155), label=c("Year-round", "Crash temps"),
color=c("#1d2951", "#6495ed")
) +
scale_x_continuous(labels = scales::label_number(suffix = "0°", limits = c(0, 400)))
ggplot(data=weatherdata, aes(x=Wind.Dir..10s.deg.)) +
geom_density(colour='#1d2951', fill='#1d2951', alpha=0.9) +
geom_density(data=alldata, colour='#6495ed', fill='#6495ed', alpha=0.6) +
xlab('Wind Direction') +
ylab('Density') +
annotate(
geom="text", x=c(72, 30), y=c(0.0175, 0.0155), label=c("Year-round", "Crash temps"),
color=c("#1d2951", "#6495ed")
) +
scale_x_continuous(labels = scales::label_number(suffix = "0°"),  limits=c(0, 400))
ggplot(data=weatherdata, aes(x=Wind.Dir..10s.deg.)) +
geom_density(colour='#1d2951', fill='#1d2951', alpha=0.9) +
geom_density(data=alldata, colour='#6495ed', fill='#6495ed', alpha=0.6) +
xlab('Wind Direction') +
ylab('Density') +
annotate(
geom="text", x=c(72, 30), y=c(0.0175, 0.0155), label=c("Year-round", "Crash temps"),
color=c("#1d2951", "#6495ed")
) +
scale_x_continuous(labels = scales::label_number(suffix = "0°"),  limits=c(0, 40))
ggplot(data=weatherdata, aes(x=Wind.Dir..10s.deg.)) +
geom_density(colour='#1d2951', fill='#1d2951', alpha=0.9) +
geom_density(data=alldata, colour='#6495ed', fill='#6495ed', alpha=0.6) +
xlab('Wind Direction') +
ylab('Density') +
annotate(
geom="text", x=c(3, 22), y=c(0.04, 0.05), label=c("Year-round", "Crash direction"),
color=c("#1d2951", "#6495ed")
) +
scale_x_continuous(labels = scales::label_number(suffix = "0°"),  limits=c(0, 40))
ggplot(data=weatherdata, aes(x=Wind.Dir..10s.deg.)) +
geom_density(colour='#1d2951', fill='#1d2951', alpha=0.9) +
geom_density(data=alldata, colour='#6495ed', fill='#6495ed', alpha=0.6) +
xlab('Wind Direction') +
ylab('Density') +
annotate(
geom="text", x=c(3, 25), y=c(0.04, 0.05), label=c("Year-round", "Crash direction"),
color=c("#1d2951", "#6495ed")
) +
scale_x_continuous(labels = scales::label_number(suffix = "0°"),  limits=c(0, 40))
names(weatherdata)
data.frame(
'Avg visibility' = mean(weatherdata$'Visibility..km.', na.rm=TRUE),
'Avg crash visibility' = mean(alldata$'Visibility..km.', na.rm = TRUE)
)
ggplot(data=weatherdata, aes(x=Visibility..km.)) +
geom_density(colour='#1d2951', fill='#1d2951', alpha=0.9) +
geom_density(data=alldata, colour='#6495ed', fill='#6495ed', alpha=0.6) +
xlab('Visibility') +
ylab('Density') +
annotate(
geom="text", x=c(3, 25), y=c(0.04, 0.05), label=c("Year-round", "Crash direction"),
color=c("#1d2951", "#6495ed")
) +
scale_x_continuous(labels = scales::label_number(suffix = "km"),  limits=c(0, 40))
ggplot(data=weatherdata, aes(x=Visibility..km.)) +
geom_density(colour='#1d2951', fill='#1d2951', alpha=0.9) +
geom_density(data=alldata, colour='#6495ed', fill='#6495ed', alpha=0.6) +
xlab('Visibility') +
ylab('Density') +
annotate(
geom="text", x=c(3, 25), y=c(0.04, 0.05), label=c("Year-round", "Crash direction"),
color=c("#1d2951", "#6495ed")
) +
scale_x_continuous(labels = scales::label_number(suffix = "km"))
ggplot(data=weatherdata, aes(x=Visibility..km.)) +
geom_density(colour='#1d2951', fill='#1d2951', alpha=0.9) +
geom_density(data=alldata, colour='#6495ed', fill='#6495ed', alpha=0.6) +
xlab('Visibility') +
ylab('Density') +
# annotate(
#   geom="text", x=c(3, 25), y=c(0.04, 0.05), label=c("Year-round", "Crash direction"),
#   color=c("#1d2951", "#6495ed")
# ) +
scale_x_continuous(labels = scales::label_number(suffix = "km"))
ggplot(data=weatherdata, aes(x=Visibility..km.)) +
geom_density(colour='#1d2951', fill='#1d2951', alpha=0.9) +
geom_density(data=alldata, colour='#6495ed', fill='#6495ed', alpha=0.6) +
xlab('Visibility') +
ylab('Density') +
# annotate(
#   geom="text", x=c(3, 25), y=c(0.04, 0.05), label=c("Year-round", "Crash direction"),
#   color=c("#1d2951", "#6495ed")
# ) +
scale_x_continuous(labels = scales::label_number(suffix = "km")) +
scale_x_log10()
ggplot(data=weatherdata, aes(x=Visibility..km.)) +
geom_density(colour='#1d2951', fill='#1d2951', alpha=0.9) +
geom_density(data=alldata, colour='#6495ed', fill='#6495ed', alpha=0.6) +
xlab('Visibility') +
ylab('Density') +
# annotate(
#   geom="text", x=c(3, 25), y=c(0.04, 0.05), label=c("Year-round", "Crash direction"),
#   color=c("#1d2951", "#6495ed")
# ) +
scale_x_continuous(labels = scales::label_number(suffix = "km"))
ggplot(data=weatherdata, aes(x=Visibility..km.)) +
geom_density(colour='#1d2951', fill='#1d2951', alpha=0.9) +
geom_density(data=alldata, colour='#6495ed', fill='#6495ed', alpha=0.6) +
xlab('Visibility') +
ylab('Density') +
# annotate(
#   geom="text", x=c(3, 25), y=c(0.04, 0.05), label=c("Year-round", "Crash direction"),
#   color=c("#1d2951", "#6495ed")
# ) +
# scale_x_continuous(labels = scales::label_number(suffix = "km")) +
scale_x_log10()
ggplot(data=weatherdata, aes(x=Visibility..km.)) +
geom_density(colour='#1d2951', fill='#1d2951', alpha=0.9) +
geom_density(data=alldata, colour='#6495ed', fill='#6495ed', alpha=0.6) +
xlab('Visibility') +
ylab('Density') +
annotate(
geom="text", x=c(3, 25), y=c(0.04, 0.05), label=c("Year-round", "Crash direction"),
color=c("#1d2951", "#6495ed")
) +
scale_x_continuous(labels = scales::label_number(suffix = "km"), limits=c(14, 20))
ggplot(data=weatherdata, aes(x=Visibility..km.)) +
geom_density(colour='#1d2951', fill='#1d2951', alpha=0.9) +
geom_density(data=alldata, colour='#6495ed', fill='#6495ed', alpha=0.6) +
xlab('Visibility') +
ylab('Density') +
annotate(
geom="text", x=c(3, 25), y=c(0.04, 0.05), label=c("Year-round", "Crash direction"),
color=c("#1d2951", "#6495ed")
) +
scale_x_continuous(labels = scales::label_number(suffix = "km"), limits=c(16, 17))
ggplot(data=weatherdata, aes(x=Visibility..km.)) +
geom_density(colour='#1d2951', fill='#1d2951', alpha=0.9) +
geom_density(data=alldata, colour='#6495ed', fill='#6495ed', alpha=0.6) +
xlab('Visibility') +
ylab('Density') +
annotate(
geom="text", x=c(3, 25), y=c(0.04, 0.05), label=c("Year-round", "Crash direction"),
color=c("#1d2951", "#6495ed")
) +
scale_x_continuous(labels = scales::label_number(suffix = "km"), limits=c(15, 18))
ggplot(data=weatherdata, aes(x=Visibility..km.)) +
geom_density(colour='#1d2951', fill='#1d2951', alpha=0.9) +
geom_density(data=alldata, colour='#6495ed', fill='#6495ed', alpha=0.6) +
xlab('Visibility') +
ylab('Density') +
scale_x_continuous(labels = scales::label_number(suffix = "km"))
alldata %>%
ggplot(aes(x=monthnumber, y=Visibility..km.)) +
geom_boxplot(aes(x=Month.Of.Year), colour='#00008b', fill='#6495ed') +
geom_smooth(stat = 'summary', alpha = 0.2, fill = '#6495ed', color = '#00008b',
fun.data = median_hilow, fun.args = list(conf.int = 1)) +
xlab('') +
ylab('Visibility') +
scale_x_discrete(labels=month.abb) +
scale_y_continuous(labels = scales::label_number(suffix = "km"))
data.frame(
'Avg visibility' = mean(weatherdata$'Visibility..km.', na.rm=TRUE),
'Avg crash visibility' = mean(alldata$'Visibility..km.', na.rm = TRUE)
)
names(alldata)
weatherdata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month)) +
geom_area(stat = 'summary', fun = mean, lty = 0,
fill = '#00008b', alpha=0.5) +
geom_area(data=alldata, aes(x=monthnumber), stat = 'summary',
fun = mean, lty = 0, fill='#6495ed', alpha=0.6) +
annotate(
geom="text", x=c(8.63, 2), y=c(0.040, 0.043), label=c("Year-round", "Crash precip."),
color=c("#00008b", "#6495ed")
) +
ylab('Precipitation') +
scale_y_continuous(labels = scales::label_number(suffix = "mm")) +
scale_x_discrete(labels=month.abb)
?scale_x_discrete
weatherdata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month)) +
geom_area(stat = 'summary', fun = mean, lty = 0,
fill = '#00008b', alpha=0.5) +
geom_area(data=alldata, aes(x=monthnumber), stat = 'summary',
fun = mean, lty = 0, fill='#6495ed', alpha=0.6) +
annotate(
geom="text", x=c(8.63, 2), y=c(0.040, 0.043), label=c("Year-round", "Crash precip."),
color=c("#00008b", "#6495ed")
) +
ylab('Precipitation') +
scale_y_continuous(labels = scales::label_number(suffix = "mm")) +
scale_x_discrete(breaks = 1:12, labels=month.abb)
weatherdata %>%
ggplot(aes(y=Precip..Amount..mm., x=Month)) +
geom_area(stat = 'summary', fun = mean, lty = 0,
fill = '#00008b', alpha=0.5) +
geom_area(data=alldata, aes(x=monthnumber), stat = 'summary',
fun = mean, lty = 0, fill='#6495ed', alpha=0.6) +
annotate(
geom="text", x=c(8.63, 2), y=c(0.040, 0.043), label=c("Year-round", "Crash precip."),
color=c("#00008b", "#6495ed")
) +
ylab('Precipitation') +
scale_y_continuous(labels = scales::label_number(suffix = "mm")) +
scale_x_continuous(breaks = 1:12, labels=month.abb)
